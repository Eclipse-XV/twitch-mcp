# Use Node.js slim image as the base\nFROM node:22.13.1-slim\n\n# Set working directory\nWORKDIR /app\n\n# Install Java (required for the Java component of your app)\nRUN apt-get update && \\\n    apt-get install -y openjdk-17-jre-headless && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n\n# Copy package files\nCOPY twitch-mcp-npm/package.json twitch-mcp-npm/package-lock.json ./\n\n# Install Node.js dependencies\nRUN npm ci --production\n\n# Copy the Node.js part of the application\nCOPY twitch-mcp-npm ./twitch-mcp-npm\n\n# Copy the Java part of the application (source files and build tools)\nCOPY pom.xml mvnw mvnw.cmd ./\nCOPY .mvn ./.mvn\nCOPY src ./src\n\n# Build the Java application\nRUN chmod +x mvnw && \\\n    ./mvnw package -DskipTests && \\\n    mv target/*.jar app.jar && \\\n    rm -rf target src .mvn pom.xml mvnw mvnw.cmd\n\n# Create a non-root user\nRUN addgroup --system appgroup && \\\n    adduser --system --ingroup appgroup appuser\n\n# Change ownership to the non-root user\nRUN chown -R appuser:appgroup /app\nUSER appuser\n\n# Expose the port\nEXPOSE 8080\n\n# Set the entrypoint and default command\nENTRYPOINT [\"node\", \"twitch-mcp-npm/bin/twitch-mcp.js\"]